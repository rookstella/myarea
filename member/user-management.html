<div>
  <h2>회원관리</h2>

<style>
  table {
    width: 100%;
    max-width: 1200px; /* 좀 더 넓게 */
    margin: auto;
    border-collapse: collapse;
    table-layout: fixed;
  }

  th, td {
    border: 1px solid #ccc;
    padding: 8px;
    text-align: center;
    overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
  }

  /* 각 열별 너비 조절 */
  th:nth-child(1), td:nth-child(1) { width: 12%; } /* 이름 */
  th:nth-child(2), td:nth-child(2) { width: 10%; } /* 아이디 */
  th:nth-child(3), td:nth-child(3) { width: 8%; }  /* 나이 */
  th:nth-child(4), td:nth-child(4) { width: 10%; }  /* 성별 */
  th:nth-child(5), td:nth-child(5) { width: 15%; } /* 전화번호 */
  th:nth-child(6), td:nth-child(6) { width: 20%; } /* 이메일 */
  th:nth-child(7), td:nth-child(7) { width: 6%; }  /* 승인 */
  th:nth-child(8), td:nth-child(8) { width: 13%; } /* 관리 */

input[type="text"],
input[type="number"],
input[type="tel"],
input[type="email"],
select {
  width: 100%;
  box-sizing: border-box;
  
}


  button {
    margin: 2px;
    padding: 4px 8px;
    cursor: pointer;
  }
</style>


  <table border="1" cellpadding="8" cellspacing="0" style="width:100%; max-width:1200px; margin:auto; border-collapse: collapse;">
    <thead>
      <tr style="background:#007bff; color:white;">
        <th>이름</th>
        <th>아이디</th>
        <th>나이</th>
        <th>성별</th>
        <th>전화번호</th>
        <th>이메일</th>
        <th>승인</th>
        <th>관리</th>
      </tr>
    </thead>
    <tbody id="userTableBody"></tbody>
  </table>
</div>

<script>
(function() {
  const userTableBody = document.getElementById('userTableBody');

  // 로그인 여부 확인 및 비로그인 시 경고 후 로그인 페이지로
  const loggedInUser = sessionStorage.getItem('loggedInUser');
  if (!loggedInUser) {
    alert('로그인이 필요합니다.');
    if(typeof loadPage === 'function') {
      loadPage('member/login.html');
    } else {
      location.href = 'member/login.html';
    }
    return; // 스크립트 진행 중단
  }

  function loadUsers() {
    const users = JSON.parse(localStorage.getItem('users')) || [];
    userTableBody.innerHTML = '';

    users.forEach((user, index) => {
      const tr = document.createElement('tr');

      tr.innerHTML = `
        <td><input type="text" value="${user.name}" data-index="${index}" data-field="name" /></td>
        <td>${user.username}</td>
        <td><input type="number" value="${user.age}" data-index="${index}" data-field="age" min="1" /></td>
        <td>
          <select data-index="${index}" data-field="gender">
            <option value="남자" ${user.gender === '남자' ? 'selected' : ''}>남자</option>
            <option value="여자" ${user.gender === '여자' ? 'selected' : ''}>여자</option>
            <option value="기타" ${user.gender === '기타' ? 'selected' : ''}>기타</option>
          </select>
        </td>
        <td><input type="tel" value="${user.phone}" data-index="${index}" data-field="phone" /></td>
        <td><input type="email" value="${user.email}" data-index="${index}" data-field="email" /></td>
        <td>
          <input type="checkbox" ${user.approved ? 'checked' : ''} data-index="${index}" data-field="approved" />
        </td>
        <td>
          <button data-action="update" data-index="${index}">수정</button>
          <button data-action="delete" data-index="${index}">삭제</button>
        </td>
      `;

      userTableBody.appendChild(tr);
    });
  }

  userTableBody.addEventListener('click', e => {
    if (e.target.tagName === 'BUTTON') {
      const index = e.target.getAttribute('data-index');
      const action = e.target.getAttribute('data-action');
      const users = JSON.parse(localStorage.getItem('users')) || [];

      if (action === 'delete') {
        if (confirm(`${users[index].username} 회원을 삭제하시겠습니까?`)) {
          users.splice(index, 1);
          localStorage.setItem('users', JSON.stringify(users));
          loadUsers();
        }
      } else if (action === 'update') {
        const rowInputs = userTableBody.querySelectorAll(`[data-index="${index}"]`);
        rowInputs.forEach(input => {
          const field = input.getAttribute('data-field');
          if (field === 'approved') {
            users[index][field] = input.checked;
          } else {
            users[index][field] = input.value;
          }
        });
        localStorage.setItem('users', JSON.stringify(users));
        alert('회원정보가 수정되었습니다.');
        loadUsers();
      }
    }
  });

  loadUsers();
})();
</script>






